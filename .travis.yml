language: c++

cache:
  ccache: true
  pip: true

addons:
  apt:
    packages:
      - clang
      - clang-format
      - llvm
      - lcov
      - ruby
      - gcc-12
      - g++-12
    update: true

jobs:
  include:
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=static-analysis
        - MATRIX_EVAL="CC=clang && CXX=clang++"
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=coverage
        - MATRIX_EVAL="CC=clang && CXX=clang++"
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=test
        - MATRIX_EVAL="CC=gcc-12 && CXX=g++-12"
    - os: linux
      dist: jammy
      env:
        - RUN_TYPE=test
        - MATRIX_EVAL="CC=clang && CXX=clang++"

before_install:
  - eval "${MATRIX_EVAL}"

install:
  - tools/ci/install.sh

script:
  - tools/ci/build.sh && tools/ci/test.sh

after_success:
  - tools/ci/after_success.sh

notifications:
  slack:
    secure: u4yTyHDPNvEEY5hWfQvVjYkmFfroQ3fOPn8T6ATzgP7DsO6Zl5pBGIdxQMNYAV3q+Qqg584J/xfRBt34MwBqVj+C+YpE146wTYsP6sRdcJtWaiMg6lDvZPMZZ9Rh053mwuHXKPcByxXuD6t9/atdJOIg0PCOdu0sq9L1Uuz/zv3ChOZe4B6ffqQjAbFx4Z++jki7XDpBYw9bqVha2d7tpsP/3PWsVdC+t15QfUp+NkMX1iPzBug0bofaHRgs7a2sBth2WrDWfK/p/FC8eM5dbBoyVuHhOiS7uBNi3411X5rtdk+uAw/Ftr4bwAFGJAOKC0/KMLu6mr5l8yOMl41gzqwjiiYYvfLQXYTEBVLAifACVnrsN3A0Fi9/PhgzaxAaThK2FqLdw1g4mBEySwQVt0/9iP/Mupl6QXE58Vfh9rnIPAnvnlF/68MhRJ3028IV8YcZLmSstchi+HJZgtRGprUO/dV6x8wuUKdzInTwkttqR1GWmL8js5OwY4nQzgoaPBcQI6t91kqJAxfw+tiTAVFhbuIqKPBFRA9mc+a7WgAynlgjZKa2otxYh3K6Q9ZaTtf3fQ1ws5uphozD0BW5rMrOFda42R+Bt7KgKSkxv7SBMs3MCRQ4E2elKYSdN4doH3nFYlSwg190avc+XOIJPquzMo3JlvdyZ/oxP2GggWU=
    on_success: never
